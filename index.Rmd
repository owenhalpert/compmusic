---
title: "Coachella Over The Years"
author: "Owen Halpert"
#date: "2023-02-14"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    theme: lumen
    orientation: rows
    css: custom.css
---

# Introduction

###### An online portfolio for Computational Musicology at the University of Amsterdam (Spring 2023) by Owen Halpert

I grew up with Coachella â€”Â as a child I was surrounded by its influence in the West Los Angeles region, in high school I was lucky enough to attend all four years, and in college I road tripped with my fellow students for the 2022 lineup.

I owe a lot of my passion for music and my broad taste in genres to attending Coachella. With an extremely diverse lineup, attendees can walk from one stage to the next and instantly be transported between wildly different musical experiences.

Even with this diversity, every year there are critics of the released Coachella lineup, as seen through the Reddit lineup announcement comments:

> Yeaâ€¦.this isnâ€™t the festival I went to in 2010ðŸ˜” -bigbrett666

> Awesome if you like pop and edm but sucks if you like live music. -dpcpv75

> This Coachella lineup is MID. No catering to the hip hop and rap fans. SMH debating selling my box -kmart2588

Some people say too much electronic, some say too little. Some say the artists are too new and unrecognizable, some complain about too many throwback artists and want more relevance.

While there is always some validity in each of these criticisms, for my project I'd like to further analyze the changing trends of Coachella artist selection. In doing so, I will analyze the growth or decline of major genres at Coachella, the regional distribution of artists, the age of artists and proximity to their "golden years", and the overall popularity of the booked names.

I expect a trend toward more electronic music, more hip hop, and more obscure artists on the lineup in the recent years. 

The Spotify tracks I will use to analyze this progression will be the yearly lineup playlists. I can then analyze and compare years as a whole. Shortcomings with this methodology might be that the selected tracks for each artist may not be representative of their true genre, that the playlists may not always be fully inclusive of all artists on the lineup, or that Goldenvoice has not released playlists for certain years, in which case I would have to use fan-made playlists. In this case, I would consider creating playlists on my own using the lineups and perhaps an automated Python script.

Looking at the [2023 lineup playlist](https://open.spotify.com/playlist/1RIp2yQ4yyNuFHqP80pCpz?si=72420310551b45aa), an extremely atypical track is He by Jai Paul. Paul was added to the lineup as an artist with a cult following who is extremely secretive and has maybe never even performed live. He is as elusive, if not more, than headliner Frank Ocean. Conversely, we see Obsessed by Calvin Harris, which we can say is much more typical, given that Harris has performed at Coachella 8 times and is one of the most mainstream EDM artists.


# 2022 vs. 2023

The below charts visualize the valence, energy, danceability and mode of the Coachella lineup for both 2022 and 2023. I find it interesting to compare how these attributes change from year to year. In a later, more refined version of these visualizations, I will make it easier for the viewer to see differences between the years. This may mean putting both years on one graph, or doing some sort of heatmap instead of a scatter plot so that the number of points isn't as jarring. 

Initial visualizations of the Coachella 2023 and 2022 playlists!

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(spotifyr)
library(ggplot2)
library(ggthemes)
library(tidyverse)
library(plotly)
library(compmus)
coachella2023 <- get_playlist_audio_features("", "2HfbF1Xx4RHhJI8jNvQAQb")
coachella2022 <- get_playlist_audio_features("", "2tcwxeUSNT7gYMzidaf5W1")
```

```{r mutate, echo=FALSE}
coachella20232 <- coachella2023 %>%               
  mutate(
    mode = ifelse(mode == 0, "Minor", "Major")
  )
coachella20222 <- coachella2022 %>%               
  mutate(
    mode = ifelse(mode == 0, "Minor", "Major")
  )
```

Row {.tabset .tabset-fade}
-------------------------------------

### 2022
```{r graph1, echo=FALSE}
plot1 <- ggplot(coachella20222, 
                aes(x = valence,
                    y = energy,
                    size = danceability,
                    color = mode)) +
  geom_point(position = "jitter", alpha = 0.4) +
  labs(x = "Valence", y = "Energy", color = "Mode", size = "Danceability", title = "Coachella 2022") +
  theme_minimal()

ggplotly(plot1)
```

### 2023
```{r graph2}
plot2 <- ggplot(coachella20232, aes(x = valence, y = energy, size = danceability, color = mode)) +
  geom_point(position = "jitter", alpha = 0.4) +
  labs(x = "Valence", y = "Energy", color = "Mode", size = "Danceability", title = "Coachella 2023") +
  theme_minimal()

ggplotly(plot2)
```

# BeyoncÃ© 2019

An important part of Coachella history (and history in general) is BeyoncÃ©'s "Homecoming" live album, which is her headline performance from Coachella 2019. This epic show was almost two hours long, and had the production quality of a Super Bowl halftime show. A Netflix documentary was made to immortalize the performance, something that is extremely rare for Coachella artists. Below, we will look at chromagrams for one of the songs she performed, "Formation", and use dynamic time warping to observe how the life performance differs from the album version. **BUG: CAN'T GET GGPLOTLY TO WORK ON 3RD TAB, DYNAMIC TIME WARPING**


Row {.tabset .tabset-fade}
-------------------------------------

### Live Chromagram

```{r beyonce_live}
beyonce_live <-
  get_tidy_audio_analysis("6oHexA34fw1WfswjIEA1hd") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

live_graph <- beyonce_live |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title = "'Formation' Live, 2019") +
  theme_minimal() +
  scale_fill_viridis_c()

ggplotly(live_graph)
```

### Recording Chromagram

```{r beyonce_recording}
beyonce_recording <-
  get_tidy_audio_analysis("6g0Orsxv6glTJCt4cHsRsQ") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)

recording_graph <- beyonce_recording |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title = "'Formation' Recording, 2016") +
  theme_minimal() +
  scale_fill_viridis_c()

ggplotly(recording_graph)
```

### Dynamic Time Warping

```{r yoncedtw}
compmus_long_distance(
  beyonce_live |> mutate(pitches = map(pitches, compmus_normalise, "manhattan")),
  beyonce_recording |> mutate(pitches = map(pitches, compmus_normalise, "manhattan")),
  feature = pitches,
  method = "manhattan"
) |>
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_equal() +
  labs(x = "Live Recording", y = "Album Recording") +
  theme_minimal() +
  scale_fill_viridis_c(guide = NULL)
```

# Discussion

Nothing yet